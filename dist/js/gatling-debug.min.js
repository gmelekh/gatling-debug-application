var gatling=angular.module("GatlingDebug",[]);gatling.filter("gatlingDate",function($filter){return function(a){return $filter("date")(a,"h:mm:ss.sss")}}),gatling.filter("gatlingTimestamp",function($filter){return function(a){var b=Math.floor(a/1e3);if(0===b)return a+" ms";var c=new Date(a),d=Math.floor(b/60);if(0===d)return $filter("date")(c,"s.sss")+" s";var e=Math.floor(d/60);return 0===e?$filter("date")(c,"m:ss.sss")+" m":$filter("date")(c,"h:mm:ss.sss")}}),gatling.factory("Exec",function($rootScope){return function(a){return angular.extend(a,{responseTime:function(){return this.responseEndDate-this.requestStartDate},startDeltaTime:function(){return $rootScope.state.delta(this.requestStartDate)},endDeltaTime:function(){return $rootScope.state.delta(this.responseEndDate)},position:function(){return $rootScope.state.positionOf(this.requestStartDate)},width:function(){return $rootScope.state.widthOf(this.responseTime())}})}}),gatling.factory("Graduation",function($rootScope){return function(a){return angular.extend(a,{position:function(){return $rootScope.state.positionOfGraduation(this.millis)},value:function(){var a=this.millis%1e3;return 0!==this.millis&&0===a%1e3?this.millis/1e3+" s":a},isThousand:function(){return 0===this.millis%1e3}})}}),gatling.factory("State",function($rootScope){return function(a){return angular.extend(a,{axisStart:function(){return Math.floor((this.currentDate-this.defaults.startDate)/100)},axisEnd:function(){return Math.floor(this.defaults.realWidth/100/this.ratio+this.axisStart())},delta:function(a){return a-$rootScope.defaults.startDate},positionOf:function(a){return(a-this.currentDate)*this.ratio},positionOfGraduation:function(a){var b=$rootScope.defaults.startDate-this.currentDate;return(a+b)*this.ratio+5},widthOf:function(a){return a*this.ratio}})}}),gatling.directive("timestamp",function($rootScope){return{restrict:"A",scope:!0,link:function(a,b){function c(a){return function(){var c=a.position(),d=a.width()+b.prop("clientWidth");c+d>=$rootScope.defaults.realWidth?b.css("right",d):b.removeAttr("style")}}$rootScope.$watch("timeline.state.currentDate",c(a.exec)),$rootScope.$watch("timeline.state.ratio",c(a.exec))}}}),gatling.controller("positionController",function($rootScope,$scope){$scope.increase=function(){$rootScope.state.currentDate+=50},$scope.decrease=function(){$rootScope.state.currentDate-=50},$scope.reset=function(){$rootScope.state.currentDate=$rootScope.defaults.startDate}}),gatling.controller("ratioController",function($rootScope,$scope){$scope.increase=function(){$rootScope.state.ratio+=.1},$scope.decrease=function(){$rootScope.state.ratio-=.1},$scope.reset=function(){$rootScope.state.ratio=$rootScope.defaults.baseRatio}}),gatling.controller("rulerController",function($rootScope,$scope,Graduation){function a(a){return 100*(a+1)}function b(b){return new Graduation({millis:a(b)})}function c(){var a=$rootScope.state;$scope.graduations=[];for(var c=a.axisStart();c<a.axisEnd();c++)$scope.graduations.push(b(c))}$rootScope.$watch("state.currentDate",c),$rootScope.$watch("state.ratio",c)}),gatling.controller("timelineController",function($rootScope,$scope,$element,State,Exec){var a=debugData[0].requestStartDate,b=debugData[debugData.length-1].responseEndDate,c=$element.find(".timeline-header.timeline-col-14").width(),d=c/(b-a),e={baseRatio:d,realWidth:c,startDate:a};$rootScope.defaults=e,$rootScope.state=new State({currentDate:a,ratio:d,defaults:e}),$scope.execs=[],angular.forEach(debugData,function(a){this.push(new Exec(a))},$scope.execs)});